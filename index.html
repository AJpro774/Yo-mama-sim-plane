<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birkslan Pacifia | 2D Debt Racer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; background: #1a1a1a; color: #fbbf24; font-family: monospace; overflow: hidden; }
        canvas { display: block; margin: 0 auto; background: #333; border: 4px solid #444; }
        .hud { position: absolute; top: 20px; width: 100%; pointer-events: none; display: flex; justify-content: space-between; padding: 0 40px; }
        .panel { bg-black/80 p-4 border border-amber-900; }
    </style>
</head>
<body>
    <div id="game-ui">
        <div id="start-screen" class="absolute inset-0 flex flex-col items-center justify-center bg-black z-50">
            <h1 class="text-6xl font-black italic mb-2 text-white italic tracking-tighter">BIRKSLAN RACING</h1>
            <p class="mb-8 text-amber-600 text-xs font-bold uppercase tracking-widest">Win 5 Races to Clear Your Debt</p>
            <div class="grid grid-cols-2 gap-4 mb-8">
                <button onclick="pickCar(0)" class="border border-amber-900 p-4 hover:bg-amber-900 transition text-xs">AE86 (Agile)</button>
                <button onclick="pickCar(1)" class="border border-amber-900 p-4 hover:bg-amber-900 transition text-xs">911 (Fast)</button>
                <button onclick="pickCar(2)" class="border border-amber-900 p-4 hover:bg-amber-900 transition text-xs">R34 (Traction)</button>
                <button onclick="pickCar(3)" class="border border-amber-900 p-4 hover:bg-amber-900 transition text-xs">F40 (Extreme)</button>
            </div>
            <p id="debt-status" class="text-red-500 mb-4 font-bold">CURRENT DEBT: $85,000</p>
        </div>

        <div class="hud">
            <div class="panel">
                <div class="text-[10px] opacity-50">SPEED</div>
                <div id="speedo" class="text-xl font-bold">0 KM/H</div>
            </div>
            <div class="panel text-right">
                <div class="text-[10px] opacity-50">DEBT REMAINING</div>
                <div id="debt-ui" class="text-xl font-bold text-red-500">$85,000</div>
                <div id="race-count" class="text-[10px] mt-1">RACE 1 / 5</div>
            </div>
        </div>
    </div>

    <canvas id="raceCanvas"></canvas>

    <script>
        const canvas = document.getElementById('raceCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = 800;
        canvas.height = 600;

        let gameActive = false;
        let debt = 85000;
        let racesWon = 0;
        
        const cars = [
            { name: "AE86", color: "#fff", speed: 5, turn: 0.08 },
            { name: "911", color: "#f00", speed: 7, turn: 0.06 },
            { name: "R34", color: "#00f", speed: 6, turn: 0.07 },
            { name: "F40", color: "#d00", speed: 9, turn: 0.04 }
        ];

        let player = {
            x: 400, y: 500, angle: -Math.PI/2,
            v: 0, car: cars[0],
            width: 20, height: 40
        };

        let keys = {};
        window.addEventListener('keydown', e => keys[e.code] = true);
        window.addEventListener('keyup', e => keys[e.code] = false);

        function pickCar(idx) {
            player.car = cars[idx];
            document.getElementById('start-screen').style.display = 'none';
            gameActive = true;
            resetRace();
        }

        function resetRace() {
            player.x = 400; player.y = 500; player.v = 0; player.angle = -Math.PI/2;
            finishLineY = -2000; // Finish line is 2000 pixels up
        }

        let finishLineY = -2000;

        function update() {
            if (!gameActive) return;

            // Input
            if (keys['ArrowUp']) player.v += 0.2;
            if (keys['ArrowDown']) player.v -= 0.2;
            if (keys['ArrowLeft']) player.angle -= player.car.turn;
            if (keys['ArrowRight']) player.angle += player.car.turn;

            player.v *= 0.97; // Friction
            if (player.v > player.car.speed) player.v = player.car.speed;

            player.x += Math.cos(player.angle) * player.v;
            player.y += Math.sin(player.angle) * player.v;

            // UI
            document.getElementById('speedo').innerText = Math.round(player.v * 20) + " KM/H";

            // Win Condition
            if (player.y < finishLineY) {
                racesWon++;
                debt -= 17000;
                if (racesWon >= 5) {
                    alert("DEBT CLEARED! YOU ARE FREE.");
                    location.reload();
                } else {
                    alert("RACE WON! $17,000 REMOVED FROM DEBT.");
                    document.getElementById('debt-ui').innerText = "$" + debt.toLocaleString();
                    document.getElementById('race-count').innerText = `RACE ${racesWon + 1} / 5`;
                    resetRace();
                }
            }
        }

        function draw() {
            ctx.fillStyle = '#222';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.save();
            // Camera follows player
            ctx.translate(canvas.width/2 - player.x, canvas.height/2 - player.y);

            // Draw Road
            ctx.fillStyle = '#444';
            ctx.fillRect(300, -5000, 200, 6000);
            
            // Finish Line
            ctx.fillStyle = '#fff';
            for(let i=0; i<10; i++) {
                ctx.fillRect(300 + (i*20), finishLineY, 20, 20);
                ctx.fillStyle = ctx.fillStyle === '#fff' ? '#000' : '#fff';
            }

            // Draw Car (Pixel Art Style)
            ctx.translate(player.x, player.y);
            ctx.rotate(player.angle + Math.PI/2);
            
            // Body
            ctx.fillStyle = player.car.color;
            ctx.fillRect(-player.width/2, -player.height/2, player.width, player.height);
            // Windows
            ctx.fillStyle = '#000';
            ctx.fillRect(-player.width/2 + 2, -player.height/2 + 5, player.width - 4, 10);
            // Spoiler
            ctx.fillStyle = '#111';
            ctx.fillRect(-player.width/2 - 2, player.height/2 - 5, player.width + 4, 3);

            ctx.restore();
        }

        function loop() {
            update();
            draw();
            requestAnimationFrame(loop);
        }
        loop();
    </script>
</body>
</html>

